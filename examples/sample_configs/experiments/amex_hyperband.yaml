search_method:
  name: Hyperband
  params:
    max_total_epochs: 5000
    max_epochs_per_arch: 5
    epochs_growth_factor: 2
trainer:
  loss: WeightCrossEntropyLoss
  metrics:
  - accuracy
  - AmexMetric
  epochs: 5
  scoring_metric: AmexMetric
  optimizer: FUSEDLAMB
  optim_params:
    lr: 0.001
    weight_decay: 0.001
  use_amp: true
dataset:
  dataset_type: WebSequenceDataset
  data_path: /data/amex/train.parquet
  batch_size: 256
  dataset_params:
    index_columns:
    - customer_ID
    sort_columns:
    - S_2
    target_column: target
    classification: true
    test_dataset: /data/amex/test.parquet
    categorical_columns:
    - B_30
    - B_38
    - D_114
    - D_116
    - D_117
    - D_120
    - D_126
    - D_63
    - D_64
    - D_66
    - D_68
    numerical_columns:
    - P_2
    - D_39
    - B_1
    - B_2
    - R_1
    - S_3
    - D_41
    - B_3
    - D_42
    - D_43
    - D_44
    - B_4
    - D_45
    - B_5
    - R_2
    - D_46
    - D_47
    - D_48
    - D_49
    - B_6
    - B_7
    - B_8
    - D_50
    - D_51
    - B_9
    - R_3
    - D_52
    - P_3
    - B_10
    - D_53
    - S_5
    - B_11
    - S_6
    - D_54
    - R_4
    - S_7
    - B_12
    - S_8
    - D_55
    - D_56
    - B_13
    - R_5
    - D_58
    - S_9
    - B_14
    - D_59
    - D_60
    - D_61
    - B_15
    - S_11
    - D_62
    - D_65
    - D_135
    - D_136
    - B_16
    - B_17
    - B_18
    - B_19
    - B_20
    - S_12
    - R_6
    - S_13
    - B_21
    - D_69
    - B_22
    - R_26
    - R_27
    - D_70
    - D_71
    - D_72
    - S_15
    - B_23
    - D_73
    - P_4
    - D_74
    - D_75
    - D_76
    - B_24
    - R_7
    - D_77
    - B_25
    - B_26
    - D_78
    - D_79
    - R_8
    - R_9
    - S_16
    - D_80
    - R_10
    - R_11
    - B_27
    - D_81
    - D_82
    - S_17
    - R_12
    - B_28
    - R_13
    - D_83
    - R_14
    - R_15
    - D_84
    - R_16
    - B_29
    - S_18
    - D_86
    - D_134
    - D_87
    - R_17
    - R_18
    - D_88
    - B_31
    - S_19
    - R_19
    - B_32
    - S_20
    - R_20
    - R_21
    - B_33
    - D_89
    - R_22
    - R_23
    - D_91
    - D_92
    - D_93
    - D_94
    - R_24
    - R_25
    - D_96
    - S_22
    - S_23
    - S_24
    - S_25
    - S_26
    - D_102
    - D_103
    - D_104
    - D_105
    - D_106
    - D_107
    - B_36
    - B_37
    - D_143
    - D_144
    - D_145
    - D_108
    - D_109
    - D_110
    - D_111
    - B_39
    - D_112
    - B_40
    - S_27
    - D_113
    - D_115
    - D_141
    - D_142
    - D_118
    - D_119
    - D_121
    - D_122
    - D_123
    - D_124
    - D_125
    - D_127
    - D_138
    - D_139
    - D_140
    - D_128
    - D_129
    - B_41
    - B_42
    - D_130
    - D_131
    - D_132
    - D_133
    - D_137
    - R_28
    seq_len_limit: 13
    seq_len_trunc_type: last
    min_partition_num: 4
    partition_size_mbytes: 64
    split_sizes:
      test: 0.0
      train: 0.8
      val: 0.2
    seed: 42
model_name: FlexibleTransformer
model:
  hidden_size: 32
  output_size: 2
  embeddings_hidden: 8
  dropout: 0.3
  tricks: choice
